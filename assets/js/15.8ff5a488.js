(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{213:function(t,s,a){"use strict";a.r(s);var n=a(0),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"用vue-node搭建网上购物商城——记录篇"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用vue-node搭建网上购物商城——记录篇"}},[t._v("#")]),t._v(" 用Vue+Node搭建网上购物商城——记录篇")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/QuiErro/WebShop",target:"_blank",rel:"noopener noreferrer"}},[t._v("github地址"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("项目采用的技术栈:  Vue+Node+MySQL"),a("br"),t._v("\n前端：用Vue-cli搭建，使用Vue全家桶+element-ui"),a("br"),t._v("\n后端：express框架"),a("br"),t._v("\n数据库：MySQL")]),t._v(" "),a("p",[t._v("其实项目初版本早就写完了，但感觉完成度不高，所以现在想完善这个项目，熟练下vue和node的开发运用，然后也记录一下我的开发过程")]),t._v(" "),a("h2",{attrs:{id:"一、功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、功能"}},[t._v("#")]),t._v(" 一、功能")]),t._v(" "),a("h3",{attrs:{id:"普通用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#普通用户"}},[t._v("#")]),t._v(" 普通用户")]),t._v(" "),a("ul",[a("li",[t._v("注册、登录（图形验证码）")]),t._v(" "),a("li",[t._v("定位 （腾讯地图定位功能）、自主选择所在城市")]),t._v(" "),a("li",[t._v("商品\n"),a("ul",[a("li",[t._v("分类")]),t._v(" "),a("li",[t._v("简单展示商品")]),t._v(" "),a("li",[t._v("查看商品详情")]),t._v(" "),a("li",[t._v("商品评论")])])]),t._v(" "),a("li",[t._v("分页功能")]),t._v(" "),a("li",[t._v("购物车功能\n"),a("ul",[a("li",[t._v("加入购物车")]),t._v(" "),a("li",[t._v("购物车商品数量增减")]),t._v(" "),a("li",[t._v("清空购物车")]),t._v(" "),a("li",[t._v("商品结算")])])]),t._v(" "),a("li",[t._v("多关键词模糊搜索商品 （关键词需为商品名称）")]),t._v(" "),a("li",[t._v("用户个人中心\n"),a("ul",[a("li",[t._v("修改用户信息 （头像、昵称、简介...）")]),t._v(" "),a("li",[t._v("修改手机号")]),t._v(" "),a("li",[t._v("修改密码")])])])]),t._v(" "),a("h3",{attrs:{id:"管理员"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理员"}},[t._v("#")]),t._v(" 管理员")]),t._v(" "),a("ul",[a("li",[t._v("登录（固定账号密码）")]),t._v(" "),a("li",[t._v("查看数据库商品信息")]),t._v(" "),a("li",[t._v("商品上架（添加商品）")]),t._v(" "),a("li",[t._v("删除/修改商品")]),t._v(" "),a("li",[t._v("分页功能")])]),t._v(" "),a("h2",{attrs:{id:"二、项目效果预览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、项目效果预览"}},[t._v("#")]),t._v(" 二、项目效果预览")]),t._v(" "),a("h3",{attrs:{id:"商城前台部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#商城前台部分"}},[t._v("#")]),t._v(" 商城前台部分")]),t._v(" "),a("h4",{attrs:{id:"首页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首页"}},[t._v("#")]),t._v(" 首页")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/14/16e67b9c7f247770?w=1346&h=657&f=gif&s=2254412",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"选择所在城市"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选择所在城市"}},[t._v("#")]),t._v(" 选择所在城市")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/13/16e622c33b96fa8e?w=811&h=244&f=png&s=28969",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"首页右侧的购物车提示区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首页右侧的购物车提示区"}},[t._v("#")]),t._v(" 首页右侧的购物车提示区")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e53ead73253d67?w=1363&h=646&f=png&s=459044",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"分类展示页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分类展示页面"}},[t._v("#")]),t._v(" 分类展示页面")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e5338f6c827851?w=1351&h=648&f=png&s=152959",alt:"分类展示页"}})]),t._v(" "),a("h4",{attrs:{id:"购物车"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#购物车"}},[t._v("#")]),t._v(" 购物车")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e53ec12409f1de?w=1350&h=647&f=png&s=89950",alt:""}})]),t._v(" "),a("h4",{attrs:{id:"商品详情页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#商品详情页"}},[t._v("#")]),t._v(" 商品详情页")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e533e7cf6ee401?w=1345&h=991&f=png&s=148317",alt:"商品详情页"}})]),t._v(" "),a("h4",{attrs:{id:"登录-注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录-注册"}},[t._v("#")]),t._v(" 登录/注册")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e534bef65cfb02?w=576&h=622&f=png&s=18566",alt:"登录/注册"}}),t._v(" "),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e534d2726bbf5f?w=379&h=371&f=png&s=8744",alt:"登录/注册"}})]),t._v(" "),a("h3",{attrs:{id:"用户中心"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户中心"}},[t._v("#")]),t._v(" 用户中心")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/13/16e622dfb01fb587?w=1349&h=598&f=png&s=41177",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"商城后台部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#商城后台部分"}},[t._v("#")]),t._v(" 商城后台部分")]),t._v(" "),a("h5",{attrs:{id:"商品信息页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#商品信息页"}},[t._v("#")]),t._v(" 商品信息页")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e53444b936925a?w=1345&h=849&f=png&s=89796",alt:"商品信息页"}})]),t._v(" "),a("h4",{attrs:{id:"添加商品"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加商品"}},[t._v("#")]),t._v(" 添加商品")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e5345a6a8f3321?w=1345&h=863&f=png&s=54525",alt:"添加商品"}})]),t._v(" "),a("h2",{attrs:{id:"三、运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、运行"}},[t._v("#")]),t._v(" 三、运行")]),t._v(" "),a("p",[t._v("项目后端服务器是基于node、MySQL开发，运行前请确认系统已安装相关应用")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/QuiErro/WebShop",target:"_blank",rel:"noopener noreferrer"}},[t._v("github地址"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("code",[t._v("git clone")])])]),t._v(" "),a("h3",{attrs:{id:"服务器端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器端"}},[t._v("#")]),t._v(" 服务器端")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cd web-server")])]),t._v(" "),a("li",[t._v("将web-server文件夹下的"),a("code",[t._v("shop.sql")]),t._v("导入MySQL数据库中")]),t._v(" "),a("li",[a("code",[t._v("npm install")]),t._v(" 安装依赖")]),t._v(" "),a("li",[t._v("修改"),a("code",[t._v("web-server/src/config.js")]),t._v("文件，此文件记录项目的全局变量，在文件中找到"),a("code",[t._v("password、database、user")]),t._v("属性，根据你的数据库信息修改它们的值")]),t._v(" "),a("li",[a("code",[t._v("npm run dev")]),t._v(" 在本地运行，启动服务器")])]),t._v(" "),a("h3",{attrs:{id:"客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[t._v("#")]),t._v(" 客户端")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("cd web-client")])]),t._v(" "),a("li",[a("code",[t._v("npm install")]),t._v("  安装依赖")]),t._v(" "),a("li",[a("code",[t._v("npm run dev")]),t._v(" 在本地运行")]),t._v(" "),a("li",[t._v("接着就可以在"),a("code",[t._v("http://localhost:8080")]),t._v("下访问到该项目")])]),t._v(" "),a("h2",{attrs:{id:"四、目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、目录结构"}},[t._v("#")]),t._v(" 四、目录结构")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v("web-client 前端部分：\n├── build                      // 构建相关  \n├── config                     // 配置相关\n├── src                        // 源代码\n│   ├── api                    \n│   |   ├── ajax.js            // 使用axios，封装ajax\n│   |   ├── index.js           // 后端接口，封装请求接口\n│   ├── common                 // 字体、图片等静态资源\n│   ├── components             // 全局公用组件\n│   ├── config                 // 全局配置\n│   |   ├── filters.js         // 全局过滤器\n│   |   ├── utils.js           // 全局方法\n│   |   ├── area.js            // 全国城市区域，配合element-ui级联选择器\n│   ├── pages                  // 项目视图页面\n│   ├── router                 // 路由配置\n│   ├── store                  // Vuex数据存储器\n│   ├── App.vue                // 入口页面\n│   ├── main.js                // 入口文件\n├── static                     // 静态资源\n├── .babelrc                   // babel-loader 配置\n├── .gitignore                 // git 忽略\n├── index.html                 // 项目html\n└── package.json               // 包依赖配置\n\nweb-server 后端部分：\n├── db                         // MySQL数据连接  \n├── public                     // 静态资源\n├── routes                     // 后端路由,项目接口\n├── static                     // 静态资源\n├── src                        // 源代码\n│   ├── app.js                 // 项目入口文件，配置，初始化\n│   ├── config.js              // 全局公用参数记录\n├── utils                      // 全局公用方法\n├── views                      // 视图页面\n├── .babelrc                   // babel-loader 配置\n├── main.js                    // 入口文件\n├── package.json               // 包依赖配置\n├── README.md                  // 项目说明文件\n└── shop.sql                   // 注入MySQL的sql语句\n")])])]),a("h2",{attrs:{id:"四、开发中的一些细节"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、开发中的一些细节"}},[t._v("#")]),t._v(" 四、开发中的一些细节")]),t._v(" "),a("h3",{attrs:{id:"_1-跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-跨域问题"}},[t._v("#")]),t._v(" 1. 跨域问题")]),t._v(" "),a("ul",[a("li",[t._v("后端部分使用"),a("code",[t._v("cors")]),t._v("来解决跨域"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("cd web"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("server\nnpm i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("S")]),t._v(" cors\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 web-server/src/app.js 中引入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" cors "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cors'")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("前端部分进行跨域配置"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 web-client/config/index.js 中进行配置")]),t._v("\nproxyTable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使'api'代替服务器地址")]),t._v("\n       target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:3000/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//源地址")]),t._v("\n       changeOrigin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//改变源")]),t._v("\n       pathRewrite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^/api'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//路径重写")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_2-登录的图形验证码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-登录的图形验证码"}},[t._v("#")]),t._v(" 2. 登录的图形验证码")]),t._v(" "),a("ul",[a("li",[t._v("项目中用的是node中的"),a("code",[t._v("svg-captcha")]),t._v("模块")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" svgCaptcha "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'svg-captcha'")]),t._v("\n\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/captcha'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成随机验证码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" captcha "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" svgCaptcha"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        color"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        noise"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ignoreChars"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0o1iIO'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        size"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 保存到session")]),t._v("\n    req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("captcha "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" captcha"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toLocaleLowerCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 验证码的文本")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回客户端，客户端接收到的是svg格式")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'svg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("captcha"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("除获取后端生成的图形验证码，前端部分还需实现点击验证码，能刷新验证码功能：")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img \n  ref"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"captcha"')]),t._v(" \n  src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:3000/api/captcha"')]),t._v(" \n  @click"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prevent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"getCaptcha()"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取图形验证码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCaptcha")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过在url后面添加查询字符串 ?time=' + new Date(),")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这样当用户每次点击验证码时，src的地址都不一样，浏览器将重新发起请求，而不是简单的304缓存")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("captcha"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:3000/api/captcha?time='")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-session失效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-session失效"}},[t._v("#")]),t._v(" 3. session失效")]),t._v(" "),a("p",[t._v("项目中用的是"),a("code",[t._v("express-session")]),t._v("来记录session，主要是记录已登录的用户id和当前前端页面获取的图形验证码文本。最开始，前端部分跨域配置中源地址写的是："),a("code",[t._v("http://127.0.0.1:3000/")]),t._v("，且获取图形验证码中也使用的"),a("code",[t._v('<img src:"http://127.0.0.1:3000/api/captcha">')]),t._v("，但后端中就是获取不到session值。\n后来看到别人的项目总结里面也发现类似问题，提到说：后端验证时，"),a("code",[t._v("http://localhost:3000")]),t._v("和"),a("code",[t._v("http://127.0.0.1:3000")]),t._v("代表的不是同一个客户端，所以访问不到session\n于是尝试把前端部分关于后端接口的地址全都改为"),a("code",[t._v("http://localhost:3000/xxx")]),t._v("形式，验证后，还真成功了")]),t._v(" "),a("h3",{attrs:{id:"_4-按需加载组件（优化首屏加载速度）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-按需加载组件（优化首屏加载速度）"}},[t._v("#")]),t._v(" 4. 按需加载组件（优化首屏加载速度）")]),t._v(" "),a("ul",[a("li",[t._v("路由懒加载"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// web-client/src/router/index.js 示例")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("Home")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./../pages/Home/Home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nroutes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Home\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_5-前台页面顶部搜索区的显示和隐藏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-前台页面顶部搜索区的显示和隐藏"}},[t._v("#")]),t._v(" 5. 前台页面顶部搜索区的显示和隐藏")]),t._v(" "),a("ul",[a("li",[t._v("通常在购物商城中，会发现页面顶部会实现搜索框，考虑到它在多个页面都会出现，于是封装成全局组件，即 "),a("code",[t._v("src\\components\\HeaderSearch\\HeaderSearch.vue")]),t._v("  并在"),a("code",[t._v("App.vue")]),t._v("中引入"),a("br"),t._v(" "),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/11/10/16e53c57b398f8a4?w=718&h=99&f=png&s=2913",alt:""}})]),t._v(" "),a("li",[t._v("然后问题出现了，有些页面其实并不需要出现搜索框，比如商品详情页、登录/注册..于是决定在"),a("code",[t._v("router")]),t._v("内动态设置"),a("code",[t._v("meta")]),t._v("，来控制全局组件的显示和隐藏"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 router\\index.js 中设置mate  示例")]),t._v("\nroutes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t  path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t  component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true 代表该路由页面显示相关的全局组件")]),t._v("\n\t  meta"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("showHeaderTop"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" showHeaderSearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 App.vue 中根据 mate 控制组件显示与隐藏")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("HeaderTop v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("show"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$route.meta.showHeaderTop"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  \n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("HeaderSearch v"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("show"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$route.meta.showHeaderSearch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("keep"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("alive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("view"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("view"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("keep"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("alive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_6-三级表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-三级表达式"}},[t._v("#")]),t._v(" 6. 三级表达式")]),t._v(" "),a("p",[t._v("在Vue中，我们通常使用"+t._s(t.data)+"插值表达式来页面取值，但是遇到需要异步请求获取数据后，再渲染到页面上时，实际上，页面渲染时会先显示数据的初始值，请求得到数据后，才会正常显示。所以有些三级表达式刚开始加载，得不到数据会报错。此时，可以结合"),a("code",[t._v("v-if")]),t._v("解决，在明确得到数据后，再渲染元素")]),t._v(" "),a("h3",{attrs:{id:"_7-封装node与mysql连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-封装node与mysql连接"}},[t._v("#")]),t._v(" 7. 封装Node与MySQL连接")]),t._v(" "),a("ul",[a("li",[t._v("可以新建一个"),a("code",[t._v("db\\db.js")]),t._v("文件,里面放数据库连接的代码，最后用"),a("code",[t._v("export default conn;")]),t._v("输出"),a("code",[t._v("conn")]),t._v("，这样在项目中操作数据库时，只需要连接一次即可，提升效率"),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mysql "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../src/config'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v("  conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库的地址")]),t._v("\n    user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 账号")]),t._v("\n    password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 密码")]),t._v("\n    database"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("database"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库名称")]),t._v("\n    multipleStatements"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许多条sql同时查询")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);